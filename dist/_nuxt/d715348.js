(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{584:function(t,n,e){"use strict";e.r(n);e(22);var r=e(10),o=(e(69),e(28),e(15),e(107)),c=e.n(o),l={layout:"admin-dashboard",data:function(){return{loading:!1,transactionsList:[]}},methods:{downloadWithdrawals:function(){this.$downloadCSV(this.transactionsList,"withdrawals-data.csv")},fetchTransactions:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var e,r,data;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.loading=!0,e=JSON.parse(window.localStorage.getItem("auth")),t.loading=!0,"\n        query {\n          getTransactions {\n            id\n            amount\n            beneficiaryName\n            beneficiaryAccountNumber\n            receivingBankName\n            routingNumber\n            wallet\n            transactionType\n            transactionStatus\n            user {\n              id\n              name\n              email\n              role\n              phoneNumber\n              dob\n              gender\n              ssn\n              occupation\n              country\n              city\n              zip\n              address\n              accountCurrency\n              pin\n              passport\n              identification\n              Status\n              PlanType\n              accountBalance\n              cardBalance\n              cardNumber\n              expiry\n              cvv\n              eth\n              btc\n              timeAdded\n            }\n            proof\n            timeAdded\n          }\n        }\n      ",n.prev=4,n.next=7,fetch("https://fidelityvalues.onrender.com/graphql/query",{method:"POST",headers:{"content-type":"application/json",authorization:"Bearer "+e},body:JSON.stringify({query:"\n        query {\n          getTransactions {\n            id\n            amount\n            beneficiaryName\n            beneficiaryAccountNumber\n            receivingBankName\n            routingNumber\n            wallet\n            transactionType\n            transactionStatus\n            user {\n              id\n              name\n              email\n              role\n              phoneNumber\n              dob\n              gender\n              ssn\n              occupation\n              country\n              city\n              zip\n              address\n              accountCurrency\n              pin\n              passport\n              identification\n              Status\n              PlanType\n              accountBalance\n              cardBalance\n              cardNumber\n              expiry\n              cvv\n              eth\n              btc\n              timeAdded\n            }\n            proof\n            timeAdded\n          }\n        }\n      "})});case 7:return r=n.sent,n.next=10,r.json();case 10:null!=(data=n.sent)&&data.errors?t.$toastr.e(data.errors[0].message):t.transactionsList=data.data.getTransactions;case 12:return n.prev=12,t.loading=!1,n.finish(12);case 15:case"end":return n.stop()}}),n,null,[[4,,12,15]])})))()},handleAction:function(data,t){var n=this;c.a.fire({title:"".concat("approve"===t?"Approve":"Reject"," Withdrawal"),text:"Please Note: You won't be able to revert this!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Proceed!"}).then((function(e){e.value?n.processTransaction(data.id,t):n.$swal("Cancelled","Action was cancelled","info")}))},processTransaction:function(t,n){var e=this;return Object(r.a)(regeneratorRuntime.mark((function r(){var o,c,l,data;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e.processing=!0,o=JSON.parse(window.localStorage.getItem("auth")),c="approve"===n?"Approved":"reject"===n?"Declined":"Pending",r.prev=3,"\n            mutation ProcessTransaction($transactionID: String!, $status: TransactionStatus!) {\n              processTransaction(transactionID: $transactionID, status: $status)\n            }\n          ",r.next=7,fetch("https://fidelityvalues.onrender.com/graphql/query",{method:"POST",headers:{"content-type":"application/json",authorization:"Bearer "+o},body:JSON.stringify({query:"\n            mutation ProcessTransaction($transactionID: String!, $status: TransactionStatus!) {\n              processTransaction(transactionID: $transactionID, status: $status)\n            }\n          ",variables:{transactionID:t,status:c}})});case 7:return l=r.sent,r.next=10,l.json();case 10:null!=(data=r.sent)&&data.errors?e.$toastr.e(data.errors[0].message):e.$toastr.s("You have successfully ".concat("approve"===n?"Approved":"Rejected"," this transaction."));case 12:return r.prev=12,e.processing=!1,r.finish(12);case 15:case"end":return r.stop()}}),r,null,[[3,,12,15]])})))()}},mounted:function(){this.fetchTransactions()}},d=e(11),component=Object(d.a)(l,(function(){var t,n,e=this,r=e._self._c;return r("div",{staticClass:"px-4 sm:px-6 lg:px-8"},[e._m(0),e._v(" "),r("div",{staticClass:"mt-8 flow-root"},[r("div",{staticClass:"-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8"},[null!==(t=e.transactionsList)&&void 0!==t&&t.length&&!e.loading?r("div",{staticClass:"inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8"},[r("table",{staticClass:"min-w-full divide-y divide-gray-300"},[e._m(1),e._v(" "),r("tbody",{staticClass:"bg-white"},e._l(e.transactionsList,(function(t){var n,o,c,l,d;return r("tr",{key:t.id,staticClass:"even:bg-gray-50"},[r("td",{staticClass:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-3"},[r("span",[e._v(e._s(null!==(n=t.user.name)&&void 0!==n?n:"Nil"))]),e._v(" "),r("span",[e._v(e._s(null!==(o=t.user.email)&&void 0!==o?o:"Nil"))])]),e._v(" "),r("td",{staticClass:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},[e._v(e._s(null!==(c=t.beneficiaryAccountNumber)&&void 0!==c?c:"Nil"))]),e._v(" "),r("td",{staticClass:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},[e._v(e._s(null!==(l=t.receivingBankName)&&void 0!==l?l:"Nil"))]),e._v(" "),r("td",{staticClass:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},[e._v(e._s(null!==(d=t.transactionStatus)&&void 0!==d?d:"Nil"))]),e._v(" "),r("td",{staticClass:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-3"},[r("div",{staticClass:"py-4"},["Pending"===(null==t?void 0:t.transactionStatus)?r("div",{staticClass:"flex items-center gap-x-3"},[r("button",{staticClass:"text-white text-xs bg-green-500 w-full py-1.5 rounded-full",on:{click:function(n){return e.handleAction(t,"approve")}}},[e._v("\n                      Approve\n                    ")]),e._v(" "),r("button",{staticClass:"text-white text-xs bg-red-500 w-full py-1.5 rounded-full",on:{click:function(n){return e.handleAction(t,"reject")}}},[e._v("\n                      Reject\n                    ")])]):r("div",[r("button",{staticClass:"bg-black text-white py-2 text-xs px-3 rounded-full",attrs:{disabled:""}},[e._v("\n                      Completed\n                    ")])])])])])})),0)])]):!e.loading||null!==(n=e.transactionsList)&&void 0!==n&&n.length?r("EmptyState",{attrs:{title:"No Transactions available",desc:""}}):r("div",{staticClass:"bg-white rounded-lg shadow-md p-4 animate-pulse"},[r("div",{staticClass:"w-full h-32 bg-gray-300 rounded mb-2"})])],1)])])}),[function(){var t=this,n=t._self._c;return n("div",{staticClass:"sm:flex sm:items-center"},[n("div",{staticClass:"sm:flex-auto"},[n("h1",{staticClass:"text-base font-semibold leading-6 text-gray-900"},[t._v("Transactions")]),t._v(" "),n("p",{staticClass:"mt-2 text-sm text-gray-700"},[t._v("A list of all the transactions in your account including their name,\n        title, email and role.")])]),t._v(" "),n("div",{staticClass:"mt-4 sm:ml-16 sm:mt-0 sm:flex-none"},[n("button",{staticClass:"block rounded-md bg-indigo-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",attrs:{type:"button"}},[t._v("Export\n        Transactions")])])])},function(){var t=this,n=t._self._c;return n("thead",[n("tr",[n("th",{staticClass:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-3",attrs:{scope:"col"}},[t._v("User")]),t._v(" "),n("th",{staticClass:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",attrs:{scope:"col"}},[t._v("Account Name")]),t._v(" "),n("th",{staticClass:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",attrs:{scope:"col"}},[t._v("Receiving Bank Name\n              ")]),t._v(" "),n("th",{staticClass:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",attrs:{scope:"col"}},[t._v("Transaction Status\n              ")]),t._v(" "),n("th",{staticClass:"relative py-3.5 pl-3 pr-4 sm:pr-3",attrs:{scope:"col"}},[n("span",{staticClass:"sr-only"},[t._v("Edit")])])])])}],!1,null,null,null);n.default=component.exports}}]);